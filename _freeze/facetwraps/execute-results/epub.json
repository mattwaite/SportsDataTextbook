{
  "hash": "247a94c4b4ee5696e800d3d36755fa73",
  "result": {
    "markdown": "# Facet wraps\n\nSometimes the easiest way to spot a trend is to chart a bunch of small things side by side. Edward Tufte, one of the most well known data visualization thinkers on the planet, calls this \"small multiples\" where ggplot calls this a facet wrap or a facet grid, depending. \n\nOne thing we noticed earlier in the semester -- it seems that a lot of teams shoot worse as the season goes on. Do they? We could answer this a number of ways, but the best way to show people would be visually. Let's use Small Multiples.\n\nAs always, we start with libraries. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n\nWe're going to use the logs of college basketball games last season.\n\n\n\n\n<pre><p><strong>For this walkthrough:</strong></p><p><a href=\"http://mattwaite.github.io/sportsdatafiles/logs20.csv\">\n  <button class=\"btn btn-danger\"><i class=\"fa fa-save\"></i> Download csv file</button>\n</a></p></pre>\n\n\n\n\nAnd load it.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogs <- read_csv(\"data/logs20.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 11097 Columns: 43\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (6): HomeAway, Opponent, W_L, Team, Conference, season\ndbl  (35): Game, TeamScore, OpponentScore, TeamFG, TeamFGA, TeamFGPCT, Team3...\nlgl   (1): Blank\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\n\n\nLet's narrow our pile and look just at the Big Ten.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbig10 <- logs |> filter(Conference == \"Big Ten\")\n```\n:::\n\n\n\n\nThe first thing we can do is look at a line chart, like we have done in previous chapters. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_line(data=big10, aes(x=Date, y=TeamFGPCT, group=Team)) + \n  scale_y_continuous(limits = c(0, .7))\n```\n\n::: {.cell-output-display}\n![](facetwraps_files/figure-epub/unnamed-chunk-5-1.png)\n:::\n:::\n\n\n\n\nAnd, not surprisingly, we get a hairball. We could color certain lines, but that would limit us to focus on one team. What if we did all of them at once? We do that with a `facet_wrap`. The only thing we MUST pass into a `facet_wrap` is what thing we're going to separate them out by. In this case, we precede that field with a tilde, so in our case we want the Team field. It looks like this: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_line(data=big10, aes(x=Date, y=TeamFGPCT, group=Team)) + \n  scale_y_continuous(limits = c(0, .7)) + \n  facet_wrap(~Team)\n```\n\n::: {.cell-output-display}\n![](facetwraps_files/figure-epub/unnamed-chunk-6-1.png)\n:::\n:::\n\n\n\n\nAnswer: Not immediately clear, but we can look at this and analyze it. We could add a piece of annotation to help us out. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbig10 |> summarise(mean(TeamFGPCT))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  `mean(TeamFGPCT)`\n              <dbl>\n1             0.436\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_hline(yintercept=.4361078, color=\"blue\") + \n  geom_line(data=big10, aes(x=Date, y=TeamFGPCT, group=Team)) + \n  scale_y_continuous(limits = c(0, .7)) + \n  facet_wrap(~Team)\n```\n\n::: {.cell-output-display}\n![](facetwraps_files/figure-epub/unnamed-chunk-8-1.png)\n:::\n:::\n\n\n\n\nWhat do you see here? How do teams compare? How do they change over time? I'm not asking you these questions because they're an assignment -- I'm asking because that's exactly what this chart helps answer. Your brain will immediately start making those connections. \n\n## Facet grid vs facet wraps\n\nFacet grids allow us to put teams on the same plane, versus just repeating them. And we can specify that plane as vertical or horizontal. For example, here's our chart from above, but using facet_grid to stack them.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_hline(yintercept=.4361078, color=\"blue\") + \n  geom_line(data=big10, aes(x=Date, y=TeamFGPCT, group=Team)) + \n  scale_y_continuous(limits = c(0, .7)) + \n  facet_grid(Team ~ .)\n```\n\n::: {.cell-output-display}\n![](facetwraps_files/figure-epub/unnamed-chunk-9-1.png)\n:::\n:::\n\n\n\n\nAnd here they are next to each other:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_hline(yintercept=.4361078, color=\"blue\") + \n  geom_line(data=big10, aes(x=Date, y=TeamFGPCT, group=Team)) + \n  scale_y_continuous(limits = c(0, .7)) + \n  facet_grid(. ~ Team)\n```\n\n::: {.cell-output-display}\n![](facetwraps_files/figure-epub/unnamed-chunk-10-1.png)\n:::\n:::\n\n\n\n\nNote: We'd have some work to do with the labeling on this -- we'll get to that -- but you can see where this is valuable comparing a group of things. One warning: Don't go too crazy with this or it loses it's visual power.\n\n## Other types\n\nLine charts aren't the only things we can do. We can do any kind of chart in ggplot. Staying with shooting, where are team's winning and losing performances coming from when we talk about team shooting and opponent shooting? \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_point(data=big10, aes(x=TeamFGPCT, y=OpponentFGPCT, color=W_L)) +\n  scale_y_continuous(limits = c(0, .7)) + \n  scale_x_continuous(limits = c(0, .7)) + \n  facet_wrap(~Team)\n```\n\n::: {.cell-output-display}\n![](facetwraps_files/figure-epub/unnamed-chunk-11-1.png)\n:::\n:::\n",
    "supporting": [
      "facetwraps_files/figure-epub"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}