{
  "hash": "1f16708377aeb2a90008f99700dd62c9",
  "result": {
    "markdown": "# Beeswarm plots\n\nA beeswarm plot is sometimes called a column scatterplot. It's an effective way to show how individual things -- teams, players, etc. -- are distributed along a numberline. The column is a grouping -- say positions in basketball -- and the dots are players, and the dots cluster where the numbers are more common. So think of it like a histogram mixed with a scatterplot crossed with a bar chart. \n\nAn example will help.\n\nFirst things first: Install ggbeeswarm with `install.packages(\"ggbeeswarm\")`\n\nLike ggalt and ggrepel, ggbeeswarm adds a couple new geoms to ggplot. We'll need to load it, the tidyverse and, for later, ggrepel.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggbeeswarm)\nlibrary(ggrepel)\n```\n:::\n\n\nAnother bit of setup: we need to set the seed for the random number generator. The library \"jitters\" the dots in the beeswarm randomly. If we don't set the seed, we'll get different results each time. Setting the seed means we get the same look. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\n```\n:::\n\n\nSo let's look at last year's basketball team as a group of shooters. The team was disappointing -- we know that -- but what kind of a problem is it going to be that we're returning basically no one from it? \n\n\n<pre><p><strong>For this walkthrough:</strong></p><p><a href=\"http://mattwaite.github.io/sportsdatafiles/players21.csv\">\n  <button class=\"btn btn-danger\"><i class=\"fa fa-save\"></i> Download csv file</button>\n</a></p></pre>\n\n\nFirst we'll load our player data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplayers <- read_csv(\"data/players21.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 5410 Columns: 58\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (9): Team, Player, Class, Pos, Height, Hometown, High School, Summary, ...\ndbl (49): #, Weight, Rk.x, G, GS, MP, FG, FGA, FG%, 2P, 2PA, 2P%, 3P, 3PA, 3...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\nWe know this data has a lot of players who didn't play, so let's get rid of them.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nactiveplayers <- players %>% filter(MP>0) \n```\n:::\n\n\nNow let's ask what makes a good shooter? The best measure, in my book, is True Shooting Percentage. It's a combination of weighted field goal shooting -- to account for three pointers -- and free throws. Our data has `TS%`, but if we include *all* players, we'll have too many dots. So let's narrow it down. A decent tool for cutoffs? Field goal attempts. Let's get a quick look at them. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(activeplayers$FGA)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00   14.00   69.00   95.38  152.00  512.00 \n```\n:::\n:::\n\n\nThe median number of shots is 69, but we only really care about good ones. So let's use 152 attempts -- the third quartile -- as our cutoff. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nshooters <- activeplayers %>% filter(FGA > 152)\n```\n:::\n\n\nNow we've got enough for a beeswarm plot. It works very much like you would expect -- the group value is the x, the number is the y. We're going to beeswarm by position, and the dots will be true shooting percentage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + geom_beeswarm(data=shooters, aes(x=Pos, y=`TS%`), color=\"grey\")\n```\n\n::: {.cell-output-display}\n![](beeswarmplots_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nYou can see that there's a lot fewer centers who have attempted more than 152 shots than guards, but then there's a lot more guards in college basketball than anything else. In the guards column, note that fat width of the swarm is between .5 and .6. So that means most guards who shoot more than 152 shots end up in that area. They're the average shooter at that level. You can see, some are better, some are worse. \n\nSo where are the Nebraska players in that mix? \n\nWe'll filter players on Nebraska who meet our criteria. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nnu <- players %>% \n  filter(Team == \"Nebraska Cornhuskers\") %>% \n  filter(FGA>152) %>% \n  arrange(desc(`TS%`))\n```\n:::\n\n\nFive Cornhuskers took more than 152 shots. Number returning this season? Three.\n\nBut how good are they as true shooters?  \n\nWhen you add another beeswarm, we need to pass another element in -- we need to tell it if we're grouping on the x value. Not sure why, but you'll get a warning if you don't. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_beeswarm(\n    data=shooters, \n    groupOnX=TRUE, \n    aes(x=Pos, y=`TS%`), color=\"grey\") + \n  geom_beeswarm(\n    data=nu, \n    groupOnX=TRUE, \n    aes(x=Pos, y=`TS%`), color=\"red\")\n```\n\n::: {.cell-output-display}\n![](beeswarmplots_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\nOoof. Best we can muster is middle of the fat part. Who is that? \n\nThis is where we can use ggrepel. Let's add a text layer and label the dots. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_beeswarm(\n    data=shooters, \n    groupOnX=TRUE, \n    aes(x=Pos, y=`TS%`), color=\"grey\") + \n  geom_beeswarm(\n    data=nu, \n    groupOnX=TRUE, \n    aes(x=Pos, y=`TS%`), color=\"red\") + \n  geom_text_repel(\n    data=nu, \n    aes(x=Pos, y=`TS%`, label=Player))\n```\n\n::: {.cell-output-display}\n![](beeswarmplots_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nSo Teddy Allen was our best shooter by true shooting percentage. The rest were below average shooters for that volume of shooting. \n\n## A few other options\n\nThe ggbeeswarm library has a couple of variations on the geom_beeswarm that may work better for your application. They are `geom_quasirandom` and `geom_jitter`. \n\nThere's not a lot to change from our example to see what they do. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_quasirandom(\n    data=shooters, \n    groupOnX=TRUE, \n    aes(x=Pos, y=`TS%`), color=\"grey\") + \n  geom_quasirandom(\n    data=nu, \n    groupOnX=TRUE, \n    aes(x=Pos, y=`TS%`), color=\"red\") + \n  geom_text_repel(\n    data=nu, \n    aes(x=Pos, y=`TS%`, label=Player))\n```\n\n::: {.cell-output-display}\n![](beeswarmplots_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nQuasirandom spreads out the dots you see in beeswarm using -- you guessed it -- quasirandom spacing. \n\nFor `geom_jitter`, we need to remove the groupOnX value. Why? No clue. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_jitter(\n    data=shooters, \n    aes(x=Pos, y=`TS%`), color=\"grey\") + \n  geom_jitter(\n    data=nu, \n    aes(x=Pos, y=`TS%`), color=\"red\") + \n  geom_text_repel(\n    data=nu, \n    aes(x=Pos, y=`TS%`, label=Player))\n```\n\n::: {.cell-output-display}\n![](beeswarmplots_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n`geom_jitter` spreads out the dots evenly across the width of the column, randomly deciding where in the line of the true shooting percentage they appear. \n\nWhich one is right for you? You're going to have to experiment and decide. This is the art in the art and a science. ",
    "supporting": [
      "beeswarmplots_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}